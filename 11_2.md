# Домашнее задание к занятию "11.02 Микросервисы: принципы"

Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- Маршрутизация запросов к нужному сервису на основе конфигурации
- Возможность проверки аутентификационной информации в запросах
- Обеспечение терминации HTTPS

Обоснуйте свой выбор.

---
Ответ:
Основываясь на статье [Choosing the Right API Gateway Pattern for Effective API Delivery](https://www.nginx.com/blog/choosing-the-right-api-gateway-pattern/)

|Возможности|Edge Gateway|Two-Tier Gateway|Microgateway|Per-Pod Gateways|Sidecar Gateways, Service Mesh|
|-|-|-|-|-|-|
|SSL|+|+|+|+|+|
|Аутентификация|+|+|+|+|+|
|Авторизация|+|+|-|-|+|
|Маршрутизация|+|+|+|+|-|
|Ограничение скорости|+|-|+|+|-|
|Логирование|-|+|-|+|+|
|Балансировака нагрузки|-|+|+|-|+|


Можно предложить решение Microgateway или Per-Pod Gateways. Оба варианта поддерживают маршрутизацию, Microgateway при использовании микросервисов может обеспечить автономноность для каждой отдельной команды(разработка отдельных сервисов).



## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- Поддержка кластеризации для обеспечения надежности
- Хранение сообщений на диске в процессе доставки
- Высокая скорость работы
- Поддержка различных форматов сообщений
- Разделение прав доступа к различным потокам сообщений
- Протота эксплуатации

Обоснуйте свой выбор.

---
Ответ:
Основываясь на статье [Сравнительный анализ AMQP брокеров сообщений для использования в качестве элемента децентрализованной системы разграничения доступа](https://www.okbsapr.ru/library/publications/shkola_kzi_chadov_mikhalchenko_2019/) сделал табличку:

|Возможности|RabbitMQ|ActiveMQ|Qpid C++|SwiftMQ|Artemis|Apollo|Apache Kafka|
|-|-|-|-|-|-|-|-|
|кластеризация|+|+|+|+|+|-|+|
|Хранение сообщений|+|+|+|+|+|+|+|
|высокая скорость работы|+|-|-|-|-|-|+|
|поддержка различных форматов сообщений|+|-|-|-|-|-|+|
|разделение прав доступа|+|+|+|+|+|+|+|
|простота эксплуатации|+|+|-|-|+|+|+|

Исходя из таблички выбираем "Кролика" или "Кафку". В конечном варианте нужно принимать решение, основанное на дополнительной информации, какие свойства являются приоритетом. При окончательном выборе можно руководствоваться статьей [Apache Kafka vs RabbitMQ в Big Data](https://www.okbsapr.ru/library/publications/shkola_kzi_chadov_mikhalchenko_2019/)
